@page "/event/{EventId:int}"
@inject Services.EventService MyEventService
@inject SessionStateService SessionState // <-- Inject the session service
@using EventApp.Models

@if (currentEvent != null)
{
    <PageTitle>@currentEvent.Name</PageTitle>
    <h1>@currentEvent.Name</h1>
    <p><strong>Date:</strong> @currentEvent.Date.ToLongDateString()</p>
    <p><strong>Location:</strong> @currentEvent.Location</p>
    
    <hr />

    @* --- UPDATE THIS SECTION TO SHOW ATTENDANCE STATUS --- *@
    @if (SessionState.IsAttending(currentEvent.Id))
    {
        <div class="alert alert-success">
            You are registered for this event!
        </div>
    }
    else
    {
        <a href="/register/@currentEvent.Id" class="btn btn-success">Register for this Event</a>
    }
    @* ---------------------------------------------------- *@

    <a href="/" class="btn btn-secondary">Back to List</a>
}
else
{
    <p>Event not found.</p>
}

@code {
    [Parameter]
    public int EventId { get; set; }
    private Event? currentEvent;

    protected override void OnInitialized()
    {
        currentEvent = MyEventService.GetEventById(EventId);
    }
}